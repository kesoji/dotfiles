# ============================================================================
# åŸºæœ¬è¨­å®š (Basic Configuration)
# ============================================================================
set -g default-shell "/bin/bash"
set -g default-command "/bin/bash"

## Prefixã‚­ãƒ¼ã‚’C-aã«å¤‰æ›´
set -g prefix C-a
unbind C-b

## ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã®ãƒ‡ã‚£ãƒ¬ã‚¤ã‚’æ¸›ã‚‰ã™ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ï¼‰
set -sg escape-time 0

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç•ªå·ã‚’è‡ªå‹•çš„ã«æŒ¯ã‚Šç›´ã™
set -g renumber-windows on

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
bind r source-file ~/.tmux.conf \; display "ğŸ”„ Reloaded!"

## C-a*2ã§tmuxå†…ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«C-aã‚’é€ã‚‹
bind C-a send-prefix

## ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿é€£æºã®æ”¹å–„ï¼‰
set -g focus-events on

## å±¥æ­´ã®ä¸Šé™ã‚’å¢—ã‚„ã™
set -g history-limit 50000

## ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤æ™‚é–“ã‚’å»¶é•·
set -g display-time 4000

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°é–“éš”ï¼ˆç§’ï¼‰
set -g status-interval 5

## ã‚¢ã‚°ãƒ¬ãƒƒã‚·ãƒ–ãƒªã‚µã‚¤ã‚ºï¼ˆè¤‡æ•°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå¯¾å¿œï¼‰
set -g aggressive-resize on
# ============================================================================
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»ãƒšã‚¤ãƒ³æ“ä½œ (Window & Pane Operations)
# ============================================================================

## Killæ“ä½œ
bind x kill-pane
bind X kill-window
bind R respawn-pane -k

## ãƒšã‚¤ãƒ³åˆ†å‰²ï¼ˆã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¼•ãç¶™ãï¼‰
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind -n M-v split-window -h -c "#{pane_current_path}"
bind -n M-| split-window -h -c "#{pane_current_path}"
bind -n M-s split-window -v -c "#{pane_current_path}"
bind -n M-- split-window -v -c "#{pane_current_path}"

## æ–°è¦ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚‚ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¼•ãç¶™ã
bind c new-window -c "#{pane_current_path}"
## ãƒšã‚¤ãƒ³ç§»å‹•ï¼ˆVimã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R
bind -n S-left select-pane -L
bind -n S-down select-pane -D
bind -n S-up select-pane -U
bind -n S-right select-pane -R

## ãƒšã‚¤ãƒ³ãƒªã‚µã‚¤ã‚ºï¼ˆç¹°ã‚Šè¿”ã—å¯èƒ½ï¼‰
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5
bind -n M-H resize-pane -L 1
bind -n M-J resize-pane -D 1
bind -n M-K resize-pane -U 1
bind -n M-L resize-pane -R 1

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
bind -n M-n next-window
bind -n M-p previous-window

## ãƒšã‚¤ãƒ³ã‚¹ãƒ¯ãƒƒãƒ—
bind-key -n M-q swap-pane -U
bind-key -n M-e swap-pane -D

## ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒˆã‚°ãƒ«
bind-key -n M-f resize-pane -Z

## ã‚»ãƒƒã‚·ãƒ§ãƒ³æ“ä½œ
bind -n M-C new-session
bind -n M-l switch-client -n
bind -n M-h switch-client -p
# ============================================================================
# ãƒã‚¦ã‚¹ã¨ç«¯æœ«è¨­å®š (Mouse & Terminal)
# ============================================================================

## ãƒã‚¦ã‚¹æ“ä½œã‚’æœ‰åŠ¹åŒ–
set -g mouse on

## True Color (RGB) ã‚µãƒãƒ¼ãƒˆ
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set -ga terminal-overrides ",*256col*:RGB"

## ã‚«ãƒ¼ã‚½ãƒ«å½¢çŠ¶ã®å¤‰æ›´ã‚’ã‚µãƒãƒ¼ãƒˆ
set -ga terminal-overrides '*:Ss=\E[%p1%d q:Se=\E[ q'

## ã‚¢ãƒ³ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ³è‰²ã®ã‚µãƒãƒ¼ãƒˆ
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'
# ============================================================================
# ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ  (Color Scheme) - Modern & Clean
# ============================================================================

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼
set -g status-style 'bg=#1e1e2e,fg=#cdd6f4'

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚¹ãƒˆ
setw -g window-status-style 'fg=#7f849c,bg=default'
setw -g window-status-current-style 'fg=#f38ba8,bg=#313244,bold'
setw -g window-status-activity-style 'fg=#f9e2af,bg=default'

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åŒºåˆ¥
set -g window-style 'fg=#bac2de,bg=#181825'
set -g window-active-style 'fg=#cdd6f4,bg=#1e1e2e'

## ãƒšã‚¤ãƒ³ãƒœãƒ¼ãƒ€ãƒ¼ï¼ˆç¾ä»£çš„ã§ã‚·ãƒ³ãƒ—ãƒ«ãªé…è‰²ï¼‰
set -g pane-border-style 'fg=#45475a'
set -g pane-active-border-style 'fg=#89b4fa,bold'

## ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ©ã‚¤ãƒ³
set -g message-style 'fg=#1e1e2e,bg=#89dceb,bold'
set -g message-command-style 'fg=#1e1e2e,bg=#89b4fa,bold'

## ãƒšã‚¤ãƒ³ãƒœãƒ¼ãƒ€ãƒ¼ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
set -g pane-border-status off
set -g pane-border-format " #{pane_index} #{pane_current_command} "
# ============================================================================
# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ (Status Bar) - Modern Design
# ============================================================================

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®ä½ç½®ã¨æ›´æ–°é »åº¦
set -g status-position top
set -g status-justify centre

## å·¦ãƒ‘ãƒãƒ«ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ï¼‰
set -g status-left-length 50
set -g status-left "#[fg=#1e1e2e,bg=#89b4fa,bold] ó°‡™ #S #[fg=#89b4fa,bg=#313244]#[fg=#cdd6f4,bg=#313244] #I:#P #[fg=#313244,bg=#1e1e2e]"

## å³ãƒ‘ãƒãƒ«ï¼ˆã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ï¼‰
set -g status-right-length 80
set -g status-right "#[fg=#313244,bg=#1e1e2e]#[fg=#cdd6f4,bg=#313244] #(tmux show-options -g prefix) #[fg=#89b4fa,bg=#313244]#[fg=#1e1e2e,bg=#89b4fa,bold]  %Y-%m-%d(%a) %H:%M "

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
setw -g window-status-format "#[fg=#7f849c] #I:#W#{?window_flags,#{window_flags}, } "
setw -g window-status-current-format "#[fg=#313244,bg=#1e1e2e]#[fg=#f38ba8,bg=#313244,bold] #I:#W#{?window_flags,#{window_flags}, } #[fg=#313244,bg=#1e1e2e]"

## ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£é€šçŸ¥
setw -g monitor-activity on
set -g visual-activity off
set -g activity-action none
# ============================================================================
# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ (Copy Mode) - Vi style
# ============================================================================

## viã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
setw -g mode-keys vi

## ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®æ“ä½œ
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi Escape send-keys -X cancel

## ã‚ˆã‚Šå¿«é©ãªã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
bind-key -T copy-mode-vi C-u send-keys -X halfpage-up
bind-key -T copy-mode-vi C-d send-keys -X halfpage-down

## ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã¸ã®ç´ æ—©ã„ã‚¢ã‚¯ã‚»ã‚¹
bind [ copy-mode
bind ] paste-buffer

# ============================================================================
# Vim-Tmux Navigator é€£æº
# ============================================================================
# https://github.com/christoomey/vim-tmux-navigator

is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind-key -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
bind-key -n C-\\ if-shell "$is_vim" "send-keys C-\\\\" "select-pane -l"

bind-key -T copy-mode-vi C-h select-pane -L
bind-key -T copy-mode-vi C-j select-pane -D
bind-key -T copy-mode-vi C-k select-pane -U
bind-key -T copy-mode-vi C-l select-pane -R
bind-key -T copy-mode-vi C-\\ select-pane -l

# ============================================================================
# ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰é€£æº (Clipboard Integration) - WSL
# ============================================================================

## win32yanké€£æºï¼ˆWSLç’°å¢ƒç”¨ï¼‰
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "win32yank.exe -i"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "win32yank.exe -i"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "win32yank.exe -i"

## Pasteã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
unbind-key -T prefix v
bind-key p run-shell "win32yank.exe -o | tmux load-buffer - && tmux paste-buffer"

## OSC 52ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚µãƒãƒ¼ãƒˆï¼ˆSSHè¶Šã—ã§ã‚‚å‹•ä½œï¼‰
set -g set-clipboard on

# ============================================================================
# ä¾¿åˆ©æ©Ÿèƒ½ (Utilities)
# ============================================================================

## ãƒˆã‚°ãƒ«ç³»
bind e setw synchronize-panes \; display "Synchronize: #{?synchronize-panes,ON,OFF}"
bind m set -g mouse \; display "Mouse: #{?mouse,ON,OFF}"

## putclipé€£æºï¼ˆäº’æ›æ€§ç¶­æŒï¼‰
if-shell "which putclip" '\
    bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "iconv -s -t SJIS | putclip"; \
    bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "iconv -s -t SJIS | putclip"; \
'

# ============================================================================
# æ–°æ©Ÿèƒ½ (Modern Features) - tmux 3.2+
# ============================================================================

## ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼ˆã‚µã‚¤ã‚ºèª¿æ•´å¯èƒ½ï¼‰
bind g display-popup -E -w 80% -h 80% -d "#{pane_current_path}"
bind G display-popup -E -w 95% -h 95% -d "#{pane_current_path}" "lazygit"

## ã‚»ãƒƒã‚·ãƒ§ãƒ³é¸æŠãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼‰
bind s display-popup -E -w 80% -h 80% "tmux list-sessions -F '#{session_name}' | fzf --reverse | xargs tmux switch-client -t"

## ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦/ãƒšã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆPowerlineã‚¢ã‚¤ã‚³ãƒ³å¯¾å¿œï¼‰
bind w choose-tree -Zw
bind W choose-tree -Zs

## ã‚¯ã‚¤ãƒƒã‚¯ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼ˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼‰
bind C-g display-popup -E -w 80% -h 80%

# ============================================================================
# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç† (Plugins) - å¿…è¦ã«å¿œã˜ã¦æœ‰åŠ¹åŒ–
# ============================================================================
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
#
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'
#
# run '~/.tmux/plugins/tpm/tpm'

# ============================================================================
# End of Configuration
# ============================================================================
